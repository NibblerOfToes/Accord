{% extends 'layout.html' %}
{% block content %}
<div class="chat-wrapper">

  <div class="chat-left">
    <div class="chat-left-header">
      <h2 class="chat-heading">Contacts</h2>
      <button id="add-contact-button" class="add-contact-button">+</button>
    </div>

    <div class="chat-left-body">
      <ul class="contact-list">
        {% for contact in contacts %}
          <li class="contact-card" data-contact-id="{{ contact[0] }}">
            <img src="{{ url_for('static', filename='images/user.png') }}" class="contact-img" alt="Profile">
            <div class="contact-info">
            <div class="contact-name">{{ contact[1] }}</div> 
            <div class="contact-preview">{{ contact[2] or "No messages yet" }}</div> 
            </div>
          </li>
        {% endfor %}
      </ul>
    </div>

    <div id="add-contact-popup" class="add-contact-popup hidden">
  <form method="POST" action="{{ url_for('add_contact_by_email') }}">
    <h3>Add Contact by Email</h3>
    <input type="email" name="contact_email" placeholder="Enter email..." required>
    <button type="submit">Add</button>
  </form>
</div>
  </div>

  <div class="chat-divider"></div>

  <div class="chat-right">
    <div class="chat-right-header">
      <h2 class="chat-heading chat-heading-right">Selected Chat</h2>
      <div class="chat-subdivider"></div>
    </div>
    <div class="chat-right-body">
      <div class="chat-messages"></div>
    </div>
    <div class="chat-input-bar">
      <input type="text" placeholder="Type message..." class="chat-input">
      <button class="chat-send-button">
        <img src="{{ url_for('static', filename='images/sendmessage.png') }}" class="contact-img" alt="Send">
      </button>
    </div>
  </div>
</div>

<script src="{{ url_for('static', filename='js/chat.js') }}"></script>
<div id="user-data" data-user-id="{{ session.userID }}"></div>
{% endblock %}